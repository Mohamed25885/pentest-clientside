from PyQt5.QtWidgets import QMainWindow, QVBoxLayout, QHBoxLayout, QLabel, QLineEdit, QPushButton,QTextEdit,QComboBox
from PyQt5.QtCore import Qt, QObject
from Widgets.SearchButton import *
from Widgets.ClearButton import *
from Widgets.ResponseBox import *
from Widgets.TargetInput import *
from Widgets.SendButton import *
from Widgets.InputBox import *
from Service.Web_vulnerability import brute_force

def setup_brute_force_tab(self: QObject, brute_force_tab):
    def clearInputs():
        self.res_box.clear_text()
        self.target_input.clear()

    button_layout = QHBoxLayout()
    search_button = SendButton()
    clear_button = ClearButton()
    button_layout.addWidget(search_button)
    button_layout.addWidget(clear_button)
    self.res_box = ResponseBox()
    clear_button.clicked.connect(clearInputs)

    api = brute_force.bruteForceService(self, button=search_button, output=self.res_box)
    layout = QVBoxLayout()
    # dial = Dialog("get", "/enums/dns/brute_force")
    # Add input box and dropdown list
    input_layout = QVBoxLayout()
    target_label = QLabel("jwt")
    self.target_input = InputBox()
    self.target_input.setPlaceholderText("jwt string")
    input_layout.addWidget(target_label)
    input_layout.addWidget(self.target_input)
    target_label2 = QLabel("Keylist(optional)")
    self.target_input2 = InputBox()
    self.target_input2.setPlaceholderText("enter values seperated by comma")
    input_layout.addWidget(target_label2)
    input_layout.addWidget(self.target_input2)
    algo_list_label = QLabel("Algorithm:")
    algo_list=QComboBox()
    options=["HS256","HS384","HS512"]
    algo_list.addItems(options)
    input_layout.addWidget(algo_list_label)
    input_layout.addWidget(algo_list)
    search_button.clicked.connect(lambda _: api.bruteForce(self.target_input.toPlainText(),self.target_input2.toPlainText().split(','),algo_list.currentText()))
    response_label = QLabel("Response:")
    layout.addLayout(input_layout)
    layout.addWidget(response_label)
    layout.addWidget(self.res_box)
    layout.addLayout(button_layout)
    brute_force_tab.setLayout(layout)
    # options_dropdown.setFixedWidth(int((input_layout.sizeHint().width())*0.8))
