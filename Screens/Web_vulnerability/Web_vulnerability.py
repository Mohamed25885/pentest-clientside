from PyQt5.QtWidgets import QMainWindow, QWidget, QVBoxLayout, QTabWidget, QPushButton
from Screens.Web_vulnerability.JWT.jwt import *
from Screens.Web_vulnerability.Open_redirect.open_redirect import *
from Screens.Web_vulnerability.Click_jacking.click_jacking import *
from Screens.Web_vulnerability.Extra.extra import setup_extra_tab

def setup_web_vulnerability_tab(parent):
    parent.sub_tabs = QTabWidget()

    # jwt_tab = QWidget()
    extra_tab = QWidget()
    open_redirect_tab = QWidget()
    click_jacking_tab = QWidget()

    # parent.sub_tabs.addTab(jwt_tab, "jwt")
    parent.sub_tabs.addTab(open_redirect_tab, "open redirect")
    parent.sub_tabs.addTab(click_jacking_tab, "click jacking")
    parent.sub_tabs.addTab(extra_tab, "Extra")

    # Add sub-tabs and button to the scanning tab layout

    layout = QVBoxLayout()
    layout.addWidget(parent.sub_tabs)

    parent.web_vulnerability_tab.setLayout(layout)
    # setup_jwt_tab(parent, jwt_tab)
    setup_extra_tab(parent, extra_tab)
    setup_open_redirect_tab(parent,open_redirect_tab)
    setup_click_jacking_tab(parent,click_jacking_tab)

