
from PyQt5.QtWidgets import QMainWindow, QVBoxLayout, QTabWidget, QWidget
from PyQt5.QtCore import Qt, QObject
from .xxe import setup_xxe_tab
from .xss import setup_xss_tab
from .xpath import setup_xpath_tab
from .ssti import setup_ssti_tab
from .crlf import setup_crlf_tab
from .cache_poisoning import setup_cache_poisoning_tab
from .bypass_403 import setup_bypass_403_tab


def setup_extra_tab(self: QObject, extra_tab):
    # Create sub-tabs for scanning
    self.sub_tabs = QTabWidget()

    xxe_tab = QWidget()
    xss_tab = QWidget()
    xpath_tab = QWidget()
    ssti_tab = QWidget()
    crlf_tab = QWidget()
    cache_poisoning_tab = QWidget()
    bypass_403_tab = QWidget()

    self.sub_tabs.addTab(xss_tab, " XSS")
    self.sub_tabs.addTab(xxe_tab, "XXE")
    self.sub_tabs.addTab(xpath_tab, "XPath")
    self.sub_tabs.addTab(ssti_tab, "SSTI")
    self.sub_tabs.addTab(crlf_tab, "CRLF")
    self.sub_tabs.addTab(cache_poisoning_tab, "Cache Poisoning")
    self.sub_tabs.addTab(bypass_403_tab, "Bypass 403")

    # Add sub-tabs and button to the scanning tab layout
    layout = QVBoxLayout()
    layout.addWidget(self.sub_tabs)

    extra_tab.setLayout(layout)
    setup_xss_tab(extra_tab, xss_tab)
    setup_xxe_tab(extra_tab, xxe_tab)
    setup_xpath_tab(extra_tab, xpath_tab)
    setup_ssti_tab(extra_tab, ssti_tab)
    setup_crlf_tab(extra_tab, crlf_tab)
    setup_cache_poisoning_tab(extra_tab, cache_poisoning_tab)
    setup_bypass_403_tab(extra_tab, bypass_403_tab)
